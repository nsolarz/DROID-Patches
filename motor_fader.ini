[p2b8]
[p2b8]
[p2b8]
[p2b8]
[p2b8]
[p2b8]
[s10]
[m4]
[m4]
[m4]
[m4]

# -------------------------------------------------
# Config
# -------------------------------------------------

[droid]
    ledbrightness = 0.5
    m4notchpower = 0

[midithrough]
    tousb = 0

# -------------------------------------------------
# Hardware Mapping
# -------------------------------------------------

[copy]
    input = S7.1
    output = _SEQUENCER_SELECT

[copy]
    input = S7.2
    output = _PAGE_SELECT

[copy]
    input = S7.3
    output = _SEQUENCER_1_SELECT

[copy]
    input = S7.4
    output = _SEQUENCER_1_SUB_CHOICE

[copy]
    input = S7.5
    output = _SEQUENCER_2_SELECT

[copy]
    input = S7.6
    output = _SEQUENCER_2_SUB_CHOICE

[copy]
    input = S7.7
    output = _SEQUENCER_3_SELECT

[copy]
    input = S7.8
    output = _SEQUENCER_3_SUB_CHOICE

[copy]
    input = S7.9
    output = _SINFONION_PRESET_SELECT

[copy]
    input = S7.10
    output = _ARP_CHORD_ENABLE

# [copy]
#   input = P6.1
#   output = _PRESET_SELECT_POT

[copy]
    input = B6.2
    output = _MOTO_GATES

[copy]
    input = B6.4
    output = _MOTO_START_END

[copy]
    input = B6.6
    output = _MOTO_GATE_PATTERN

[copy]
    input = B6.8
    output = _MOTO_SKIP

[copy]
    output = L6.2
    input = _MOTO_GATES_LED

[copy]
    output = L6.4
    input = _MOTO_START_END_LED

[copy]
    output = L6.6
    input = _MOTO_GATE_PATTERN_LED

[copy]
    output = L6.8
    input = _MOTO_SKIP_LED

[copy]
    input = B6.1
    output = _MOTO_P1

[copy]
    input = B6.3
    output = _MOTO_P2

[copy]
    output = L6.1
    input = _MOTO_P1_LED

[copy]
    output = L6.3
    input = _MOTO_P2_LED

[copy]
    input = B6.5
    output = _SAVE

[copy]
    input = B6.7
    output = _LOAD

[copy]
    input = B1.5
    output = _ALGO_LENGTH_BUTTON

[copy]
    input = B1.6
    output = _ALGO_ALT_BUTTON

[copy]
    input = B4.5
    output = _ALGO_PREV_PATTERN_BUTTON

[copy]
    input = B4.6
    output = _ALGO_NEXT_PATTERN_BUTTON

[copy]
    input = P1.1
    output = _ALGO_ACTIVITY_POT

[copy]
    input = P1.2
    output = _ALGO_VARIATION_POT

[copy]
    input = P2.1
    output = _ALGO_DEJAVU_POT

[copy]
    input = P2.2
    output = _ALGO_MORPH_POT

[copy]
    input = P3.1
    output = _ALGO_OFFBEATS_POT

[copy]
    input = P3.2
    output = _ALGO_BRANCHES_POT

[copy]
    input = P4.1
    output = _ALGO_ALL_ACTIVITY_POT

[copy]
    input = P4.2
    output = _ALGO_ALL_FILLS_POT

[copy]
    input = P5.1
    output = _LUCKY_CHANCE_POT

[copy]
    input = P5.2
    output = _LUCKY_AMOUNT_POT

[copy]
    input = B5.1
    output = _LUCKY_FADERS

[copy]
    input = B5.2
    output = _LUCKY_BUTTONS

[copy]
    input = B5.3
    output = _LUCKY_CVS

[copy]
    input = B5.4
    output = _LUCKY_GATES

[copy]
    input = B5.5
    output = _LUCKY_CV_SPREAD

[copy]
    input = B5.6
    output = _PASTE

[copy]
    input = B5.7
    output = _CLEAR

[copy]
    input = B5.8
    output = _COPY

[copy]
    input = _SEQUENCER_1_CV
    output = O1

[copy]
    input = _SEQUENCER_1_GATE
    output = G1

[copy]
    input = _SEQUENCER_2_CV
    output = O2

[copy]
    input = _SEQUENCER_2_GATE
    output = G2

[copy]
    input = _SEQUENCER_3_CV
    output = O3

[copy]
    input = _SEQUENCER_3_GATE
    output = G3

[copy]
    output = O8
    input = _SINF_CHOICE

[copy]
    output = G8
    input = _ARP_GATE

# -------------------------------------------------
# Selection Constants
# -------------------------------------------------

[copy]
    input = 0
    output = _SEQUENCER_1

[copy]
    input = 5
    output = _ALGOQUENCER_1

[copy]
    input = 1
    output = _SUB_SEQUENCER_1

[copy]
    input = 2
    output = _SEQUENCER_2

[copy]
    input = 1
    output = _ALGOQUENCER_2

[copy]
    input = 3
    output = _SUB_SEQUENCER_2

[copy]
    input = 4
    output = _SEQUENCER_3

[copy]
    input = 2
    output = _ALGOQUENCER_3

[copy]
    input = 5
    output = _SUB_SEQUENCER_3

[copy]
    input = 3
    output = _CHORD_ARP

[copy]
    input = 4
    output = _MATRIX

# -------------------------------------------------
# Universal controls
# -------------------------------------------------

[buttongroup]
    button1 = _MOTO_GATES
    button2 = _MOTO_START_END
    button3 = _MOTO_GATE_PATTERN
    button4 = _MOTO_SKIP
    led1 = _MOTO_GATES_LED
    led2 = _MOTO_START_END_LED
    led3 = _MOTO_GATE_PATTERN_LED
    led4 = _MOTO_SKIP_LED
    output = _BUTTONMODE

[buttongroup]
    button1 = _MOTO_P1
    button2 = _MOTO_P2
    led1 = _MOTO_P1_LED
    led2 = _MOTO_P2_LED
    output = _PAGE

[pot]
    pot = _LUCKY_CHANCE_POT
    ledgauge = 0.65
    output = _LUCKY_CHANCE

[pot]
    pot = _LUCKY_AMOUNT_POT
    ledgauge = 0.75
    output = _LUCKY_AMOUNT

[pot]
    ledgauge = 0.35
    pot = _ALGO_ALL_ACTIVITY_POT
    notch = 0.1
    bipolar = _ALGO_ALL_ACTIVITY

[pot]
    ledgauge = 0.5
    pot = _ALGO_ALL_FILLS_POT
    output = _ALGO_ALL_FILLS

[switch]
    input1 = _ALGOQUENCER_1
    input2 = _ALGOQUENCER_1
    input3 = _ALGOQUENCER_2
    input4 = _ALGOQUENCER_2
    input5 = _ALGOQUENCER_3
    input6 = _ALGOQUENCER_3
    input7 = _CHORD_ARP
    input8 = _MATRIX
    offset = _SEQUENCER_SELECT
    output1 = _LEFT_SELECT_BUTTONS

[switch]
    input1 = _ALGOQUENCER_1
    input2 = _ALGOQUENCER_1
    input3 = _ALGOQUENCER_2
    input4 = _ALGOQUENCER_2
    input5 = _ALGOQUENCER_3
    input6 = _ALGOQUENCER_3
    input7 = _CHORD_ARP
    input8 = _MATRIX
    offset = _SEQUENCER_SELECT
    output1 = _PRESET_SELECT

[switch]
    input1 = 0
    input2 = 0
    input3 = 1
    offset = _SINFONION_PRESET_SELECT
    output1 = _SINFONION_PRESET_SELECT_CHOICE

# -------------------------------------------------
# Clock
# -------------------------------------------------

[midiin]
    clock16 = _CLOCK16 # 16th note
    stop = _STOP
    clock4 = _CLOCK4 # Quarter note
    clock8 = _CLOCK8

[clocktool]
    reset = _STOP
    output = _CLOCK1BAR # 1 Bar
    gatelength = 0.5
    divide = 4
    clock = _CLOCK4

# -------------------------------------------------
# Sinfonion
# -------------------------------------------------

[notebuttons]
    select = _SINFONION_PRESET_SELECT_CHOICE
    selectat = 0
    button1 = B1.7
    button2 = B1.8
    button3 = B2.7
    button4 = B2.8
    button5 = B3.7
    button6 = B3.8
    button7 = B4.7
    button8 = B4.8
    button9 = B2.5
    button10 = B2.6
    button11 = B3.5
    button12 = B3.6
    led1 = L1.7
    led2 = L1.8
    led3 = L2.7
    led4 = L2.8
    led5 = L3.7
    led6 = L3.8
    led7 = L4.7
    led8 = L4.8
    led9 = L2.5
    led10 = L2.6
    led11 = L3.5
    led12 = L3.6
    semitone = _SINF_CHOICE
    clock = _CLOCK16

# -------------------------------------------------
# Alyseum Matrix
# -------------------------------------------------

[buttongroup]
    select = _PRESET_SELECT * _SINFONION_PRESET_SELECT_CHOICE
    selectat = _MATRIX
    button1 = B1.7
    button2 = B1.8
    button3 = B2.7
    button4 = B2.8
    button5 = B3.7
    button6 = B3.8
    button7 = B4.7
    button8 = B4.8
    led1 = L1.7
    led2 = L1.8
    led3 = L2.7
    led4 = L2.8
    led5 = L3.7
    led6 = L3.8
    led7 = L4.7
    led8 = L4.8
    output = _MATRIX_PRESET

[button]
    select = _PRESET_SELECT
    selectat = _MATRIX
    button = _SAVE
    output = _MATRIX_SAVE

[button]
    select = _PRESET_SELECT
    selectat = _MATRIX
    button = _LOAD
    output = _MATRIX_LOAD

[buttongroup]
    select = _LEFT_SELECT_BUTTONS
    selectat = _MATRIX
    preset = _MATRIX_PRESET
    loadpreset = _MATRIX_LOAD
    savepreset = _MATRIX_SAVE
    button1 = B1.1
    button2 = B1.2
    button3 = B2.1
    button4 = B2.2
    button5 = B3.1
    button6 = B3.2
    button7 = B4.1
    button8 = B4.2
    led1 = L1.1
    led2 = L1.2
    led3 = L2.1
    led4 = L2.2
    led5 = L3.1
    led6 = L3.2
    led7 = L4.1
    led8 = L4.2
    output = _MATRIX_A_PRESET

[midiout]
    programchange = _CLOCK1BAR
    program = _MATRIX_A_PRESET + 1
    channel = 4

[buttongroup]
    select = _LEFT_SELECT_BUTTONS
    selectat = _MATRIX
    preset = _MATRIX_PRESET
    loadpreset = _MATRIX_LOAD
    savepreset = _MATRIX_SAVE
    button1 = B1.3
    button2 = B1.4
    button3 = B2.3
    button4 = B2.4
    button5 = B3.3
    button6 = B3.4
    button7 = B4.3
    button8 = B4.4
    led1 = L1.3
    led2 = L1.4
    led3 = L2.3
    led4 = L2.4
    led5 = L3.3
    led6 = L3.4
    led7 = L4.3
    led8 = L4.4
    output = _MATRIX_B_PRESET

[midiout]
    programchange = _CLOCK1BAR
    program = _MATRIX_B_PRESET + 1
    channel = 5

# -------------------------------------------------
# Sequencer 1
# -------------------------------------------------

[buttongroup]
    select = _PRESET_SELECT * _SINFONION_PRESET_SELECT_CHOICE
    selectat = _ALGOQUENCER_1
    button1 = B3.7
    button2 = B3.8
    button3 = B4.7
    button4 = B4.8
    led1 = L3.7
    led2 = L3.8
    led3 = L4.7
    led4 = L4.8
    output = _SEQUENCER_1_PRESET

# #### Main motor
# [pot]
#   select = _PRESET_SELECT
#   selectat = _ALGOQUENCER_1
#   pot = _PRESET_SELECT_POT
#   discrete = 4
#   output = _SEQUENCER_1_PRESET

[button]
    select = _PRESET_SELECT
    selectat = _ALGOQUENCER_1
    button = _SAVE
    output = _SEQUENCER_1_SAVE

[button]
    select = _PRESET_SELECT
    selectat = _ALGOQUENCER_1
    button = _LOAD
    output = _SEQUENCER_1_LOAD

[button]
    select = _SEQUENCER_SELECT
    selectat = _SEQUENCER_1
    button = _COPY
    output = _SEQUENCER_1_COPY

[button]
    select = _SEQUENCER_SELECT
    selectat = _SEQUENCER_1
    button = _PASTE
    output = _SEQUENCER_1_PASTE

[button]
    button = _CLEAR
    select = _SEQUENCER_SELECT
    selectat = _SEQUENCER_1
    longpress = _CLEAR_1

[motoquencer]
    clock = _CLOCK16
    reset = _STOP
    select = _SEQUENCER_SELECT
    selectat = _SEQUENCER_1
    fadermode = _PAGE_SELECT
    buttonmode = _BUTTONMODE
    clear = _CLEAR_1
    copy = _SEQUENCER_1_COPY
    paste = _SEQUENCER_1_PASTE
    copymode = 1 # only the current page
    startstep = 1
    endstep = 16 # default to 16 step sequence after a clear
    defaultgate = 0 # No gates after a clear
    loadpreset = _SEQUENCER_1_LOAD
    savepreset = _SEQUENCER_1_SAVE
    preset = _SEQUENCER_1_PRESET
    page = _PAGE
    numfaders = 16
    numsteps = 32
    cv = _MOTO_1_CV
    gate = _MOTO_1_GATE
    transpose = _SUB_1_SAMPLED_CV_MOTO_1 * _SUB_1_TRANSPOSE_DIR
    luckychance = _LUCKY_CHANCE
    luckyamount = _LUCKY_AMOUNT
    luckyfaders = _LUCKY_FADERS
    luckybuttons = _LUCKY_BUTTONS
    luckycvs = _LUCKY_CVS
    luckyspread = _LUCKY_CV_SPREAD
    luckygates = _LUCKY_GATES

# #### Algoquencer
[pot]
    pot = _ALGO_ACTIVITY_POT
    notch = 0.1
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_1
    loadpreset = _SEQUENCER_1_LOAD
    savepreset = _SEQUENCER_1_SAVE
    preset = _SEQUENCER_1_PRESET
    output = _ALGO_1_ACTIVITY

[pot]
    pot = _ALGO_VARIATION_POT
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_1
    loadpreset = _SEQUENCER_1_LOAD
    savepreset = _SEQUENCER_1_SAVE
    preset = _SEQUENCER_1_PRESET
    output = _ALGO_1_VARIATION

[pot]
    pot = _ALGO_DEJAVU_POT
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_1
    loadpreset = _SEQUENCER_1_LOAD
    savepreset = _SEQUENCER_1_SAVE
    preset = _SEQUENCER_1_PRESET
    output = _ALGO_1_DEJAVU

[pot]
    pot = _ALGO_MORPH_POT
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_1
    loadpreset = _SEQUENCER_1_LOAD
    savepreset = _SEQUENCER_1_SAVE
    preset = _SEQUENCER_1_PRESET
    output = _ALGO_1_MORPHS

[pot]
    pot = _ALGO_OFFBEATS_POT
    notch = 0.1
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_1
    loadpreset = _SEQUENCER_1_LOAD
    savepreset = _SEQUENCER_1_SAVE
    preset = _SEQUENCER_1_PRESET
    output = _ALGO_1_OFFBEATS

[pot]
    pot = _ALGO_BRANCHES_POT
    discrete = 4
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_1
    loadpreset = _SEQUENCER_1_LOAD
    savepreset = _SEQUENCER_1_SAVE
    preset = _SEQUENCER_1_PRESET
    output = _ALGO_1_BRANCHES

[button]
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_1
    button = _ALGO_PREV_PATTERN_BUTTON
    output = _ALGO_1_PREV_PATTERN

[button]
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_1
    button = _ALGO_NEXT_PATTERN_BUTTON
    output = _ALGO_1_NEXT_PATTERN

[algoquencer]
    clock = _CLOCK16
    reset = _STOP
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_1
    loadpreset = _SEQUENCER_1_LOAD
    savepreset = _SEQUENCER_1_SAVE
    preset = _SEQUENCER_1_PRESET
    lengthbutton = _ALGO_LENGTH_BUTTON
    alternatebutton = _ALGO_ALT_BUTTON
    activity = _ALGO_1_ACTIVITY + _ALGO_ALL_ACTIVITY
    variation = _ALGO_1_VARIATION
    pitchhigh = 0.2
    pitchlow = 0
    dejavu = _ALGO_1_DEJAVU
    morphs = _ALGO_1_MORPHS
    offbeats = _ALGO_1_OFFBEATS
    branches = _ALGO_1_BRANCHES
    prevpattern = _ALGO_1_PREV_PATTERN
    nextpattern = _ALGO_1_NEXT_PATTERN
    fills = _ALGO_ALL_FILLS
    pitch = _ALGO_1_CV
    gate = _ALGO_1_GATE
    button1 = B1.1
    button2 = B1.2
    button3 = B2.1
    button4 = B2.2
    button5 = B3.1
    button6 = B3.2
    button7 = B4.1
    button8 = B4.2
    button9 = B1.3
    button10 = B1.4
    button11 = B2.3
    button12 = B2.4
    button13 = B3.3
    button14 = B3.4
    button15 = B4.3
    button16 = B4.4
    led1 = L1.1
    led2 = L1.2
    led3 = L2.1
    led4 = L2.2
    led5 = L3.1
    led6 = L3.2
    led7 = L4.1
    led8 = L4.2
    led9 = L1.3
    led10 = L1.4
    led11 = L2.3
    led12 = L2.4
    led13 = L3.3
    led14 = L3.4
    led15 = L4.3
    led16 = L4.4

[math]
    input1 = _ALGO_1_CV
    input2 = _SUB_1_SAMPLED_CV_ALGO_1 * _SUB_1_TRANSPOSE_DIR
    sum = _ALGO_1_TRANSPOSED_CV

# ####  Sub motor
[motoquencer]
    select = _SEQUENCER_SELECT
    selectat = _SUB_SEQUENCER_1
    clock = _CLOCK4
    reset = _STOP
    fadermode = _PAGE_SELECT
    buttonmode = _BUTTONMODE
    startstep = 1
    endstep = 16 # default to 16 step sequence after a clear
    clear = _CLEAR_1_SUB
    loadpreset = _SEQUENCER_1_LOAD
    savepreset = _SEQUENCER_1_SAVE
    preset = _SEQUENCER_1_PRESET
    copy = _SUB_SEQUENCER_1_COPY
    paste = _SUB_SEQUENCER_1_PASTE
    copymode = 1 # only the current page
    page = _PAGE
    numfaders = 16
    numsteps = 32
    cv = _SUB_1_CV
    gate = _SUB_1_GATE
    gatelength = 0.99
    cvbase = 0
    cvrange = 0.1
    luckychance = _LUCKY_CHANCE
    luckyamount = _LUCKY_AMOUNT
    luckyfaders = _LUCKY_FADERS
    luckybuttons = _LUCKY_BUTTONS
    luckycvs = _LUCKY_CVS
    luckyspread = _LUCKY_CV_SPREAD
    luckygates = _LUCKY_GATES

[sample]
    input = _SUB_1_CV
    sample = _MOTO_1_GATE
    output = _SUB_1_SAMPLED_CV_MOTO_1

[sample]
    input = _SUB_1_CV
    sample = _ALGO_1_GATE
    output = _SUB_1_SAMPLED_CV_ALGO_1

[button]
    button = _CLEAR
    select = _SEQUENCER_SELECT
    selectat = _SUB_SEQUENCER_1
    longpress = _CLEAR_1_SUB

[button]
    select = _SEQUENCER_SELECT
    selectat = _SUB_SEQUENCER_1
    button = _COPY
    output = _SUB_SEQUENCER_1_COPY

[button]
    select = _SEQUENCER_SELECT
    selectat = _SUB_SEQUENCER_1
    button = _PASTE
    output = _SUB_SEQUENCER_1_PASTE

[logic]
    input1 = _ALGO_1_GATE
    input2 = _SUB_1_GATE
    and = _ALGO_1_GATE_MASKED

[logic]
    input1 = _MOTO_1_GATE
    input2 = _SUB_1_GATE
    and = _MOTO_1_GATE_MASKED

# Sequencer choice for output 1
[switch]
    input1 = _ALGO_1_TRANSPOSED_CV
    input2 = 0
    input3 = _MOTO_1_CV
    offset = _SEQUENCER_1_SELECT
    output1 = _SEQUENCER_1_CV

[switch]
    input1 = _ALGO_1_GATE_MASKED
    input2 = 0
    input3 = _MOTO_1_GATE_MASKED
    offset = _SEQUENCER_1_SELECT
    output1 = _SEQUENCER_1_GATE

# Subsequencer transpose up or down
[switch]
    input1 = -1
    input2 = 0
    input3 = 1
    offset = _SEQUENCER_1_SUB_CHOICE
    output1 = _SUB_1_TRANSPOSE_DIR

# -------------------------------------------------
# Sequencer 2
# -------------------------------------------------

[buttongroup]
    select = _PRESET_SELECT * _SINFONION_PRESET_SELECT_CHOICE
    selectat = _ALGOQUENCER_2
    button1 = B3.7
    button2 = B3.8
    button3 = B4.7
    button4 = B4.8
    led1 = L3.7
    led2 = L3.8
    led3 = L4.7
    led4 = L4.8
    output = _SEQUENCER_2_PRESET

# #### Main motor
# [pot]
#   select = _PRESET_SELECT
#   selectat = _ALGOQUENCER_1
#   pot = _PRESET_SELECT_POT
#   discrete = 4
#   output = _SEQUENCER_1_PRESET

[button]
    select = _PRESET_SELECT
    selectat = _ALGOQUENCER_2
    button = _SAVE
    output = _SEQUENCER_2_SAVE

[button]
    select = _PRESET_SELECT
    selectat = _ALGOQUENCER_2
    button = _LOAD
    output = _SEQUENCER_2_LOAD

[button]
    select = _SEQUENCER_SELECT
    selectat = _SEQUENCER_2
    button = _COPY
    output = _SEQUENCER_2_COPY

[button]
    select = _SEQUENCER_SELECT
    selectat = _SEQUENCER_2
    button = _PASTE
    output = _SEQUENCER_2_PASTE

[button]
    button = _CLEAR
    select = _SEQUENCER_SELECT
    selectat = _SEQUENCER_2
    longpress = _CLEAR_2

[motoquencer]
    clock = _CLOCK16
    reset = _STOP
    select = _SEQUENCER_SELECT
    selectat = _SEQUENCER_2
    fadermode = _PAGE_SELECT
    buttonmode = _BUTTONMODE
    clear = _CLEAR_2
    copy = _SEQUENCER_2_COPY
    paste = _SEQUENCER_2_PASTE
    copymode = 1 # only the current page
    startstep = 1
    endstep = 16 # default to 16 step sequence after a clear
    defaultgate = 0 # No gates after a clear
    loadpreset = _SEQUENCER_2_LOAD
    savepreset = _SEQUENCER_2_SAVE
    preset = _SEQUENCER_2_PRESET
    page = _PAGE
    numfaders = 16
    numsteps = 32
    cv = _MOTO_2_CV
    gate = _MOTO_2_GATE
    transpose = _SUB_2_SAMPLED_CV_MOTO_2 * _SUB_2_TRANSPOSE_DIR
    luckychance = _LUCKY_CHANCE
    luckyamount = _LUCKY_AMOUNT
    luckyfaders = _LUCKY_FADERS
    luckybuttons = _LUCKY_BUTTONS
    luckycvs = _LUCKY_CVS
    luckyspread = _LUCKY_CV_SPREAD
    luckygates = _LUCKY_GATES

# #### Algoquencer
[pot]
    pot = _ALGO_ACTIVITY_POT
    notch = 0.1
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_2
    loadpreset = _SEQUENCER_2_LOAD
    savepreset = _SEQUENCER_2_SAVE
    preset = _SEQUENCER_2_PRESET
    output = _ALGO_2_ACTIVITY

[pot]
    pot = _ALGO_VARIATION_POT
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_2
    loadpreset = _SEQUENCER_2_LOAD
    savepreset = _SEQUENCER_2_SAVE
    preset = _SEQUENCER_2_PRESET
    output = _ALGO_2_VARIATION

[pot]
    pot = _ALGO_DEJAVU_POT
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_2
    loadpreset = _SEQUENCER_2_LOAD
    savepreset = _SEQUENCER_2_SAVE
    preset = _SEQUENCER_2_PRESET
    output = _ALGO_2_DEJAVU

[pot]
    pot = _ALGO_MORPH_POT
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_2
    loadpreset = _SEQUENCER_2_LOAD
    savepreset = _SEQUENCER_2_SAVE
    preset = _SEQUENCER_2_PRESET
    output = _ALGO_2_MORPHS

[pot]
    pot = _ALGO_OFFBEATS_POT
    notch = 0.1
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_2
    loadpreset = _SEQUENCER_2_LOAD
    savepreset = _SEQUENCER_2_SAVE
    preset = _SEQUENCER_2_PRESET
    output = _ALGO_2_OFFBEATS

[pot]
    pot = _ALGO_BRANCHES_POT
    discrete = 4
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_2
    loadpreset = _SEQUENCER_2_LOAD
    savepreset = _SEQUENCER_2_SAVE
    preset = _SEQUENCER_2_PRESET
    output = _ALGO_2_BRANCHES

[button]
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_2
    button = _ALGO_PREV_PATTERN_BUTTON
    output = _ALGO_2_PREV_PATTERN

[button]
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_2
    button = _ALGO_NEXT_PATTERN_BUTTON
    output = _ALGO_2_NEXT_PATTERN

[algoquencer]
    clock = _CLOCK16
    reset = _STOP
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_2
    loadpreset = _SEQUENCER_2_LOAD
    savepreset = _SEQUENCER_2_SAVE
    preset = _SEQUENCER_2_PRESET
    lengthbutton = _ALGO_LENGTH_BUTTON
    alternatebutton = _ALGO_ALT_BUTTON
    activity = _ALGO_2_ACTIVITY + _ALGO_ALL_ACTIVITY
    variation = _ALGO_2_VARIATION
    dejavu = _ALGO_2_DEJAVU
    morphs = _ALGO_2_MORPHS
    offbeats = _ALGO_2_OFFBEATS
    branches = _ALGO_2_BRANCHES
    prevpattern = _ALGO_2_PREV_PATTERN
    nextpattern = _ALGO_2_NEXT_PATTERN
    fills = _ALGO_ALL_FILLS
    pitch = _ALGO_2_CV
    gate = _ALGO_2_GATE
    button1 = B1.1
    button2 = B1.2
    button3 = B2.1
    button4 = B2.2
    button5 = B3.1
    button6 = B3.2
    button7 = B4.1
    button8 = B4.2
    button9 = B1.3
    button10 = B1.4
    button11 = B2.3
    button12 = B2.4
    button13 = B3.3
    button14 = B3.4
    button15 = B4.3
    button16 = B4.4
    led1 = L1.1
    led2 = L1.2
    led3 = L2.1
    led4 = L2.2
    led5 = L3.1
    led6 = L3.2
    led7 = L4.1
    led8 = L4.2
    led9 = L1.3
    led10 = L1.4
    led11 = L2.3
    led12 = L2.4
    led13 = L3.3
    led14 = L3.4
    led15 = L4.3
    led16 = L4.4

[math]
    input1 = _ALGO_2_CV
    input2 = _SUB_2_SAMPLED_CV_ALGO_2 * _SUB_2_TRANSPOSE_DIR
    sum = _ALGO_2_TRANSPOSED_CV

# ####  Sub motor
[motoquencer]
    select = _SEQUENCER_SELECT
    selectat = _SUB_SEQUENCER_2
    clock = _CLOCK4
    reset = _STOP
    fadermode = _PAGE_SELECT
    buttonmode = _BUTTONMODE
    startstep = 1
    endstep = 16 # default to 16 step sequence after a clear
    clear = _CLEAR_2_SUB
    loadpreset = _SEQUENCER_2_LOAD
    savepreset = _SEQUENCER_2_SAVE
    preset = _SEQUENCER_2_PRESET
    copy = _SUB_SEQUENCER_2_COPY
    paste = _SUB_SEQUENCER_2_PASTE
    copymode = 1 # only the current page
    page = _PAGE
    numfaders = 16
    numsteps = 32
    cv = _SUB_2_CV
    gate = _SUB_2_GATE
    gatelength = 0.99
    cvbase = 0
    cvrange = 0.1
    luckychance = _LUCKY_CHANCE
    luckyamount = _LUCKY_AMOUNT
    luckyfaders = _LUCKY_FADERS
    luckybuttons = _LUCKY_BUTTONS
    luckycvs = _LUCKY_CVS
    luckyspread = _LUCKY_CV_SPREAD
    luckygates = _LUCKY_GATES

[sample]
    input = _SUB_2_CV
    sample = _MOTO_2_GATE
    output = _SUB_2_SAMPLED_CV_MOTO_2

[sample]
    input = _SUB_2_CV
    sample = _ALGO_2_GATE
    output = _SUB_2_SAMPLED_CV_ALGO_2

[button]
    button = _CLEAR
    select = _SEQUENCER_SELECT
    selectat = _SUB_SEQUENCER_2
    longpress = _CLEAR_2_SUB

[button]
    select = _SEQUENCER_SELECT
    selectat = _SUB_SEQUENCER_2
    button = _COPY
    output = _SUB_SEQUENCER_2_COPY

[button]
    select = _SEQUENCER_SELECT
    selectat = _SUB_SEQUENCER_2
    button = _PASTE
    output = _SUB_SEQUENCER_2_PASTE

[logic]
    input1 = _ALGO_2_GATE
    input2 = _SUB_2_GATE
    and = _ALGO_2_GATE_MASKED

[logic]
    input1 = _MOTO_2_GATE
    input2 = _SUB_2_GATE
    and = _MOTO_2_GATE_MASKED

# Sequencer choice for output 1
[switch]
    input1 = _ALGO_2_TRANSPOSED_CV
    input2 = 0
    input3 = _MOTO_2_CV
    offset = _SEQUENCER_2_SELECT
    output1 = _SEQUENCER_2_CV

[switch]
    input1 = _ALGO_2_GATE_MASKED
    input2 = 0
    input3 = _MOTO_2_GATE_MASKED
    offset = _SEQUENCER_2_SELECT
    output1 = _SEQUENCER_2_GATE

# Subsequencer transpose up or down
[switch]
    input1 = -1
    input2 = 0
    input3 = 1
    offset = _SEQUENCER_2_SUB_CHOICE
    output1 = _SUB_2_TRANSPOSE_DIR

# -------------------------------------------------
# Sequencer 3
# -------------------------------------------------

[buttongroup]
    select = _PRESET_SELECT * _SINFONION_PRESET_SELECT_CHOICE
    selectat = _ALGOQUENCER_3
    button1 = B3.7
    button2 = B3.8
    button3 = B4.7
    button4 = B4.8
    led1 = L3.7
    led2 = L3.8
    led3 = L4.7
    led4 = L4.8
    output = _SEQUENCER_3_PRESET

# #### Main motor
# [pot]
#   select = _PRESET_SELECT
#   selectat = _ALGOQUENCER_1
#   pot = _PRESET_SELECT_POT
#   discrete = 4
#   output = _SEQUENCER_1_PRESET

[button]
    select = _PRESET_SELECT
    selectat = _ALGOQUENCER_3
    button = _SAVE
    output = _SEQUENCER_3_SAVE

[button]
    select = _PRESET_SELECT
    selectat = _ALGOQUENCER_3
    button = _LOAD
    output = _SEQUENCER_3_LOAD

[button]
    select = _SEQUENCER_SELECT
    selectat = _SEQUENCER_3
    button = _COPY
    output = _SEQUENCER_3_COPY

[button]
    select = _SEQUENCER_SELECT
    selectat = _SEQUENCER_3
    button = _PASTE
    output = _SEQUENCER_3_PASTE

[button]
    button = _CLEAR
    select = _SEQUENCER_SELECT
    selectat = _SEQUENCER_3
    longpress = _CLEAR_3

[motoquencer]
    clock = _CLOCK16
    reset = _STOP
    select = _SEQUENCER_SELECT
    selectat = _SEQUENCER_3
    fadermode = _PAGE_SELECT
    buttonmode = _BUTTONMODE
    clear = _CLEAR_3
    copy = _SEQUENCER_3_COPY
    paste = _SEQUENCER_3_PASTE
    copymode = 1 # only the current page
    startstep = 1
    endstep = 16 # default to 16 step sequence after a clear
    defaultgate = 0 # No gates after a clear
    loadpreset = _SEQUENCER_3_LOAD
    savepreset = _SEQUENCER_3_SAVE
    preset = _SEQUENCER_3_PRESET
    page = _PAGE
    numfaders = 16
    numsteps = 32
    cv = _MOTO_3_CV
    gate = _MOTO_3_GATE
    transpose = _SUB_3_SAMPLED_CV_MOTO_3 * _SUB_3_TRANSPOSE_DIR
    luckychance = _LUCKY_CHANCE
    luckyamount = _LUCKY_AMOUNT
    luckyfaders = _LUCKY_FADERS
    luckybuttons = _LUCKY_BUTTONS
    luckycvs = _LUCKY_CVS
    luckyspread = _LUCKY_CV_SPREAD
    luckygates = _LUCKY_GATES

# #### Algoquencer
[pot]
    pot = _ALGO_ACTIVITY_POT
    notch = 0.1
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_3
    loadpreset = _SEQUENCER_3_LOAD
    savepreset = _SEQUENCER_3_SAVE
    preset = _SEQUENCER_3_PRESET
    output = _ALGO_3_ACTIVITY

[pot]
    pot = _ALGO_VARIATION_POT
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_3
    loadpreset = _SEQUENCER_3_LOAD
    savepreset = _SEQUENCER_3_SAVE
    preset = _SEQUENCER_3_PRESET
    output = _ALGO_3_VARIATION

[pot]
    pot = _ALGO_DEJAVU_POT
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_3
    loadpreset = _SEQUENCER_3_LOAD
    savepreset = _SEQUENCER_3_SAVE
    preset = _SEQUENCER_3_PRESET
    output = _ALGO_3_DEJAVU

[pot]
    pot = _ALGO_MORPH_POT
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_3
    loadpreset = _SEQUENCER_3_LOAD
    savepreset = _SEQUENCER_3_SAVE
    preset = _SEQUENCER_3_PRESET
    output = _ALGO_3_MORPHS

[pot]
    pot = _ALGO_OFFBEATS_POT
    notch = 0.1
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_3
    loadpreset = _SEQUENCER_3_LOAD
    savepreset = _SEQUENCER_3_SAVE
    preset = _SEQUENCER_3_PRESET
    output = _ALGO_3_OFFBEATS

[pot]
    pot = _ALGO_BRANCHES_POT
    discrete = 4
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_3
    loadpreset = _SEQUENCER_3_LOAD
    savepreset = _SEQUENCER_3_SAVE
    preset = _SEQUENCER_3_PRESET
    output = _ALGO_3_BRANCHES

[button]
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_3
    button = _ALGO_PREV_PATTERN_BUTTON
    output = _ALGO_3_PREV_PATTERN

[button]
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_3
    button = _ALGO_NEXT_PATTERN_BUTTON
    output = _ALGO_3_NEXT_PATTERN

[algoquencer]
    clock = _CLOCK16
    reset = _STOP
    select = _LEFT_SELECT_BUTTONS
    selectat = _ALGOQUENCER_3
    loadpreset = _SEQUENCER_3_LOAD
    savepreset = _SEQUENCER_3_SAVE
    preset = _SEQUENCER_3_PRESET
    lengthbutton = _ALGO_LENGTH_BUTTON
    alternatebutton = _ALGO_ALT_BUTTON
    activity = _ALGO_3_ACTIVITY + _ALGO_ALL_ACTIVITY
    variation = _ALGO_3_VARIATION
    dejavu = _ALGO_3_DEJAVU
    morphs = _ALGO_3_MORPHS
    offbeats = _ALGO_3_OFFBEATS
    branches = _ALGO_3_BRANCHES
    prevpattern = _ALGO_3_PREV_PATTERN
    nextpattern = _ALGO_3_NEXT_PATTERN
    fills = _ALGO_ALL_FILLS
    pitch = _ALGO_3_CV
    gate = _ALGO_3_GATE
    button1 = B1.1
    button2 = B1.2
    button3 = B2.1
    button4 = B2.2
    button5 = B3.1
    button6 = B3.2
    button7 = B4.1
    button8 = B4.2
    button9 = B1.3
    button10 = B1.4
    button11 = B2.3
    button12 = B2.4
    button13 = B3.3
    button14 = B3.4
    button15 = B4.3
    button16 = B4.4
    led1 = L1.1
    led2 = L1.2
    led3 = L2.1
    led4 = L2.2
    led5 = L3.1
    led6 = L3.2
    led7 = L4.1
    led8 = L4.2
    led9 = L1.3
    led10 = L1.4
    led11 = L2.3
    led12 = L2.4
    led13 = L3.3
    led14 = L3.4
    led15 = L4.3
    led16 = L4.4

[math]
    input1 = _ALGO_3_CV
    input2 = _SUB_3_SAMPLED_CV_ALGO_3 * _SUB_3_TRANSPOSE_DIR
    sum = _ALGO_3_TRANSPOSED_CV

# ####  Sub motor
[motoquencer]
    select = _SEQUENCER_SELECT
    selectat = _SUB_SEQUENCER_3
    clock = _CLOCK4
    reset = _STOP
    fadermode = _PAGE_SELECT
    buttonmode = _BUTTONMODE
    startstep = 1
    endstep = 16 # default to 16 step sequence after a clear
    clear = _CLEAR_3_SUB
    loadpreset = _SEQUENCER_3_LOAD
    savepreset = _SEQUENCER_3_SAVE
    preset = _SEQUENCER_3_PRESET
    copy = _SUB_SEQUENCER_3_COPY
    paste = _SUB_SEQUENCER_3_PASTE
    copymode = 1 # only the current page
    page = _PAGE
    numfaders = 16
    numsteps = 32
    cv = _SUB_3_CV
    gate = _SUB_3_GATE
    gatelength = 0.99
    cvbase = 0
    cvrange = 0.1
    luckychance = _LUCKY_CHANCE
    luckyamount = _LUCKY_AMOUNT
    luckyfaders = _LUCKY_FADERS
    luckybuttons = _LUCKY_BUTTONS
    luckycvs = _LUCKY_CVS
    luckyspread = _LUCKY_CV_SPREAD
    luckygates = _LUCKY_GATES

[sample]
    input = _SUB_3_CV
    sample = _MOTO_3_GATE
    output = _SUB_3_SAMPLED_CV_MOTO_3

[sample]
    input = _SUB_3_CV
    sample = _ALGO_3_GATE
    output = _SUB_3_SAMPLED_CV_ALGO_3

[button]
    button = _CLEAR
    select = _SEQUENCER_SELECT
    selectat = _SUB_SEQUENCER_3
    longpress = _CLEAR_3_SUB

[button]
    select = _SEQUENCER_SELECT
    selectat = _SUB_SEQUENCER_3
    button = _COPY
    output = _SUB_SEQUENCER_3_COPY

[button]
    select = _SEQUENCER_SELECT
    selectat = _SUB_SEQUENCER_3
    button = _PASTE
    output = _SUB_SEQUENCER_3_PASTE

[logic]
    input1 = _ALGO_3_GATE
    input2 = _SUB_3_GATE
    and = _ALGO_3_GATE_MASKED

[logic]
    input1 = _MOTO_3_GATE
    input2 = _SUB_3_GATE
    and = _MOTO_3_GATE_MASKED

# Sequencer choice for output 1
[switch]
    input1 = _ALGO_3_TRANSPOSED_CV
    input2 = 0
    input3 = _MOTO_3_CV
    offset = _SEQUENCER_3_SELECT
    output1 = _SEQUENCER_3_CV

[switch]
    input1 = _ALGO_3_GATE_MASKED
    input2 = 0
    input3 = _MOTO_3_GATE_MASKED
    offset = _SEQUENCER_3_SELECT
    output1 = _SEQUENCER_3_GATE

# Subsequencer transpose up or down
[switch]
    input1 = -1
    input2 = 0
    input3 = 1
    offset = _SEQUENCER_3_SUB_CHOICE
    output1 = _SUB_3_TRANSPOSE_DIR

# -------------------------------------------------
# Chord/Arp
# -------------------------------------------------

[math]
    input1 = _GATESPREAD * 0.5
    input2 = 1
    product = _NOTE2DELAY

[math]
    input1 = _GATESPREAD * 0.5
    input2 = 2
    product = _NOTE3DELAY

[math]
    input1 = _GATESPREAD * 0.5
    input2 = 3
    product = _NOTE4DELAY

[switch]
    input1 = 0
    input2 = _NOTE2DELAY
    input3 = _NOTE3DELAY
    input4 = _NOTE4DELAY
    forward = _NOTEGATE
    reset = _STOP
    output1 = _NOTE1DELAYSWITCH
    output2 = _NOTE2DELAYSWITCH
    output3 = _NOTE3DELAYSWITCH
    output4 = _NOTE4DELAYSWITCH

[triggerdelay]
    input = _NOTEGATE
    delay = _NOTE1DELAYSWITCH
    gatelength = _GATESPREAD * 0.5 + 0.2
    output = _NOTE1GATE

[triggerdelay]
    input = _NOTEGATE
    delay = _NOTE2DELAYSWITCH
    gatelength = _GATESPREAD * 0.5 + 0.2
    output = _NOTE2GATE

[triggerdelay]
    input = _NOTEGATE
    delay = _NOTE3DELAYSWITCH
    gatelength = _GATESPREAD * 0.5 + 0.2
    output = _NOTE3GATE

[triggerdelay]
    input = _NOTEGATE
    delay = _NOTE4DELAYSWITCH
    gatelength = _GATESPREAD * 0.5 + 0.2
    output = _NOTE4GATE

[algoquencer]
    preset = _CHORD_ARP_PRESET
    savepreset = _CHORD_ARP_SAVE
    loadpreset = _CHORD_ARP_LOAD
    select = _LEFT_SELECT_BUTTONS
    selectat = _CHORD_ARP
    button1 = B1.1
    button2 = B1.2
    button3 = B2.1
    button4 = B2.2
    button5 = B3.1
    button6 = B3.2
    button7 = B4.1
    button8 = B4.2
    led1 = L1.1
    led2 = L1.2
    led3 = L2.1
    led4 = L2.2
    led5 = L3.1
    led6 = L3.2
    led7 = L4.1
    led8 = L4.2
    clock = _CLOCK8
    gatelength = 0.5
    length = 8
    reset = _STOP
    gate = _CHORD_ALGO_GATE

[compare]
    ifgreater = 1
    input = _ARP_CHORD_ENABLE
    compare = 0.9
    output = _CHORD_ENABLE

[logic]
    input1 = _CHORD_ENABLE
    input2 = _CHORD_ALGO_GATE
    and = _NOTEGATE

[compare]
    ifgreater = 1
    input = _ARP_CHORD_ENABLE
    compare = 1.9
    output = _ARP_ENABLE

[logic]
    input1 = _ARP_ENABLE
    input2 = _ARP_ALGO_GATE
    and = _ARP_GATE

[algoquencer]
    preset = _CHORD_ARP_PRESET
    savepreset = _CHORD_ARP_SAVE
    loadpreset = _CHORD_ARP_LOAD
    select = _LEFT_SELECT_BUTTONS
    selectat = _CHORD_ARP
    button1 = B1.3
    button2 = B1.4
    button3 = B2.3
    button4 = B2.4
    button5 = B3.3
    button6 = B3.4
    button7 = B4.3
    button8 = B4.4
    led1 = L1.3
    led2 = L1.4
    led3 = L2.3
    led4 = L2.4
    led5 = L3.3
    led6 = L3.4
    led7 = L4.3
    led8 = L4.4
    clock = _CLOCK16
    gatelength = 0.5
    length = 8
    reset = _STOP
    gate = _ARP_ALGO_GATE

[pot]
    preset = _CHORD_ARP_PRESET
    savepreset = _CHORD_ARP_SAVE
    loadpreset = _CHORD_ARP_LOAD
    output = _GATESPREAD
    select = _LEFT_SELECT_BUTTONS
    selectat = _CHORD_ARP
    pot = _ALGO_ACTIVITY_POT

[midiout]
    channel = 16
    velocity1 = 0.7
    velocity2 = 0.7
    velocity3 = 0.7
    velocity4 = 0.7
    pitch1 = I1
    pitch2 = I2
    gate1 = _NOTE1GATE
    gate2 = _NOTE2GATE
    gate3 = _NOTE3GATE
    gate4 = _NOTE4GATE
    pitch3 = I3
    pitch4 = I4

[button]
    select = _PRESET_SELECT
    selectat = _CHORD_ARP
    button = _SAVE
    output = _CHORD_ARP_SAVE

[button]
    select = _PRESET_SELECT
    selectat = _CHORD_ARP
    button = _LOAD
    output = _CHORD_ARP_LOAD

[buttongroup]
    select = _PRESET_SELECT * _SINFONION_PRESET_SELECT_CHOICE
    selectat = _CHORD_ARP
    button1 = B1.7
    button2 = B1.8
    button3 = B2.7
    button4 = B2.8
    button5 = B3.7
    button6 = B3.8
    button7 = B4.7
    button8 = B4.8
    led1 = L1.7
    led2 = L1.8
    led3 = L2.7
    led4 = L2.8
    led5 = L3.7
    led6 = L3.8
    led7 = L4.7
    led8 = L4.8
    output = _CHORD_ARP_PRESET
